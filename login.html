<!-- login.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login | MESS-MATE</title>
  <link rel="stylesheet" href="common.css" />
  <link rel="stylesheet" href="index.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Added Font Awesome for icons to match dashboard -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
  <header class="navbar">
    <div class="logo"><i class="fas fa-utensils"></i> MESS-MATE</div>
    <nav>
      <a href="#reset" id="clear-local-data"><i class="fas fa-trash-alt"></i> Clear Local Data</a>
    </nav>
  </header>

  <main style="min-height: 80vh; display: flex; align-items: center; justify-content: center; max-width: 800px; margin: 0 auto; padding: 2rem;">
    <section class="card" id="auth-section">
      <h2>Welcome to MESS-MATE</h2>
      <p>Please sign up if you're new or log in if you already have an account.</p>

      <div style="display:flex; gap:1rem; margin-bottom:1rem;">
        <button id="show-signup" type="button">Sign Up</button>
        <button id="show-login" type="button">Log In</button>
      </div>

      <form id="signup-form" style="display:none;">
        <input id="signup-name" type="text" placeholder="Full Name" required />
        <input id="signup-id" type="text" placeholder="Unique ID (username)" required />
        <input id="signup-email" type="email" placeholder="Gmail" required />
        <div style="display:flex; gap:1rem; align-items:center; margin:0.5rem 0;">
          <button id="send-otp" type="button">Send OTP</button>
          <input id="signup-otp" type="text" placeholder="Enter OTP (6 digits)" inputmode="numeric" pattern="[0-9]{6}" />
        </div>
        <p id="otp-status" style="color:#ffb3b3"></p>
        <input id="signup-password" type="password" placeholder="Password (min 6 chars)" required />
        <button type="submit">Continue</button>
        <p id="signup-error" style="color:#ffb3b3"></p>
      </form>

      <form id="login-form" style="display:none;">
        <input id="login-id" type="text" placeholder="Unique ID or Gmail" required />
        <input id="login-password" type="password" placeholder="Password" required />
        <button type="submit">Continue</button>
        <p id="login-error" style="color:#ffb3b3"></p>
      </form>
    </section>

    <section class="card" id="post-auth-section" style="display:none;">
      <h2>Choose an option</h2>
      <p>After login/sign up, you can create a mess (as manager) or join an existing mess.</p>

      <div style="display:flex; gap:1rem; margin-bottom:1rem;">
        <button id="choose-create" type="button">Create Mess</button>
        <button id="choose-join" type="button">Join Mess</button>
        <button id="proceed-dashboard" type="button" style="display:none;">Proceed to Dashboard</button>
      </div>

      <form id="create-mess-form" style="display:none;">
        <input id="create-mess-id" type="text" placeholder="Mess ID (unique)" required />
        <input id="create-mess-password" type="password" placeholder="Mess Password" required />
        <button type="submit">Create</button>
        <p id="create-mess-error" style="color:#ffb3b3"></p>
      </form>

      <form id="join-mess-form" style="display:none;">
        <input id="join-mess-id" type="text" placeholder="Existing Mess ID" required />
        <input id="join-mess-password" type="password" placeholder="Mess Password" required />
        <button type="submit">Join</button>
        <p id="join-mess-error" style="color:#ffb3b3"></p>
      </form>
    </section>
  </main>

  <script src="config.js"></script>
  <script src="supabase-config.js"></script>
  <script src="app-init.js"></script>
  <script src="auth-service.js"></script>
  <script src="data-service.js"></script>
  <script src="login-supabase.js"></script>
</body>
</html>